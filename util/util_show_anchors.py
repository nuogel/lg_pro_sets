import numpy as np
import cv2

img = cv2.imread('person.png') * 0 + 255

anchors16 = [[4.9, 12.533333333333333],  # the average iou is:0.7764558498530564
             [10.15, 8.703703703703702],
             [6.6499999999999995, 14.274074074074074],
             [6.6499999999999995, 18.8],
             [8.75, 16.362962962962964],
             [8.4, 22.977777777777778],
             [16.1, 14.622222222222222],
             [24.5, 11.14074074074074],
             [12.25, 29.592592592592595],
             [15.399999999999999, 41.77777777777778],
             [32.9, 21.933333333333334],
             [23.45, 58.14074074074074],
             [31.5, 84.25185185185185],
             [67.9, 42.474074074074075],
             [51.45, 127.42222222222223],
             [101.14999999999999, 197.05185185185184]]

apollo_anchors = [[4.9434993, 1.516986], [2.1259836, 1.6779645], [19.452609, 17.815241],
                  [3.1458852, 2.4994355], [15.0302664, 2.3736405], [1.2374577, 2.8255595],
                  [5.5330938, 3.605915], [2.4232311, 0.8086055], [0.3672315, 0.6450615],
                  [1.3549788, 1.2046775], [0.9085392, 0.726555], [0.772209, 2.031382],
                  [4.0958478, 9.108235], [0.5070438, 1.26041], [10.0207692, 6.877788],
                  [1.9708173, 4.677844]]

anchors12 = [[5.95, 13.925925925925926],  # average iou:0.75
             [9.8, 9.4],
             [7.35, 17.755555555555556],
             [8.4, 22.977777777777778],
             [18.900000000000002, 13.229629629629631],
             [12.6, 29.940740740740743],
             [15.75, 42.474074074074075],
             [39.2, 25.066666666666666],
             [23.45, 58.14074074074074],
             [31.849999999999998, 83.55555555555556],
             [55.3, 118.02222222222223],
             [100.45, 198.79259259259257]]

anchors9 = [[5.6, 13.577777777777776],
            [7.35, 17.05925925925926],
            [15.05, 10.792592592592593],
            [9.1, 24.02222222222222],
            [14.35, 36.20740740740741],
            [30.45, 20.192592592592593],
            [26.25, 66.84444444444445],
            [62.300000000000004, 40.03703703703704],
            [64.05, 143.43703703703704]]
# the average iou is:
# 0.7143684866680754


apollo_anchors_2_vga = [[4.9434993, 1.516986], [2.1259836, 1.6779645], [19.452609, 17.815241],
                        [3.1458852, 2.4994355], [15.0302664, 2.3736405], [1.2374577, 2.8255595],
                        [5.5330938, 3.605915], [2.4232311, 0.8086055], [0.3672315, 0.6450615],
                        [1.3549788, 1.2046775], [0.9085392, 0.726555], [0.772209, 2.031382],
                        [4.0958478, 9.108235], [0.5070438, 1.26041], [10.0207692, 6.877788],
                        [1.9708173, 4.677844]]

img = cv2.resize(img, (1672, 876))

tiny_yolo_anchors = [[10, 14], [23, 27], [37, 58], [81, 82], [135, 169], [344, 319]]

for i in range(len(tiny_yolo_anchors)):
    img = cv2.rectangle(img, (800, 5), (800 + int(tiny_yolo_anchors[i][0]), 5 + int(tiny_yolo_anchors[i][1])), (255, 0, 0))
#
#
#
# for i in range(16):
#     img = cv2.rectangle(img, (400, 5), (400 + int(anchors16[i][0]), 5 + int(anchors16[i][1])), (255, 0, 0))
#     img = cv2.rectangle(img, (600, 5),
#                         (600 + int(apollo_anchors[i][0] / 64 * 672), 5 + int(apollo_anchors[i][1] / 24 * 376)),
#                         (255, 0, 0))
#     img = cv2.rectangle(img, (100, 1), (100 + 672, 376), (0, 0, 220))
#
# for i in range(12):
#     img = cv2.rectangle(img, (200, 5), (200 + int(anchors12[i][0]), 5 + int(anchors12[i][1])), (255, 0, 0))
#
# for i in range(9):
#     img = cv2.rectangle(img, (100, 5), (100 + int(anchors9[i][0]), 5 + int(anchors9[i][1])), (255, 0, 0))

print('anchors16')
for i in range(16):
    print('[', '%.7f' % (anchors16[i][0] / 16), ',', '%.7f' % (anchors16[i][1] / 16), '],')
print('anchors12')
for i in range(12):
    print('[', '%.7f' % (anchors12[i][0] / 16), ',', '%.7f' % (anchors12[i][1] / 16), '],')
print('anchors9')
for i in range(9):
    print('[', '%.7f' % (anchors9[i][0] / 16), ',', '%.7f' % (anchors9[i][1] / 16), '],')

print('apollo_anchors')
for i in range(16):
    print('[', '%.7f' % (apollo_anchors[i][0] / 64), ',', '%.7f' % (apollo_anchors[i][1] / 24), '],')

print('tiny_yolo_anchors')
for i in range(len(tiny_yolo_anchors)):
    print('[', '%.7f' % (tiny_yolo_anchors[i][0] / 416), ',', '%.7f' % (tiny_yolo_anchors[i][1] / 416), '],')
cv2.imshow('img', img)
cv2.waitKey()





##########################################
# anchors16
# [ 0.3062500 , 0.7833333 ],
# [ 0.6343750 , 0.5439815 ],
# [ 0.4156250 , 0.8921296 ],
# [ 0.4156250 , 1.1750000 ],
# [ 0.5468750 , 1.0226852 ],
# [ 0.5250000 , 1.4361111 ],
# [ 1.0062500 , 0.9138889 ],
# [ 1.5312500 , 0.6962963 ],
# [ 0.7656250 , 1.8495370 ],
# [ 0.9625000 , 2.6111111 ],
# [ 2.0562500 , 1.3708333 ],
# [ 1.4656250 , 3.6337963 ],
# [ 1.9687500 , 5.2657407 ],
# [ 4.2437500 , 2.6546296 ],
# [ 3.2156250 , 7.9638889 ],
# [ 6.3218750 , 12.3157407 ],
# anchors12
# [ 0.3718750 , 0.8703704 ],
# [ 0.6125000 , 0.5875000 ],
# [ 0.4593750 , 1.1097222 ],
# [ 0.5250000 , 1.4361111 ],
# [ 1.1812500 , 0.8268519 ],
# [ 0.7875000 , 1.8712963 ],
# [ 0.9843750 , 2.6546296 ],
# [ 2.4500000 , 1.5666667 ],
# [ 1.4656250 , 3.6337963 ],
# [ 1.9906250 , 5.2222222 ],
# [ 3.4562500 , 7.3763889 ],
# [ 6.2781250 , 12.4245370 ],
# anchors9
# [ 0.3500000 , 0.8486111 ],
# [ 0.4593750 , 1.0662037 ],
# [ 0.9406250 , 0.6745370 ],
# [ 0.5687500 , 1.5013889 ],
# [ 0.8968750 , 2.2629630 ],
# [ 1.9031250 , 1.2620370 ],
# [ 1.6406250 , 4.1777778 ],
# [ 3.8937500 , 2.5023148 ],
# [ 4.0031250 , 8.9648148 ],
